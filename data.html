<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.7.5/dist/sweetalert2.all.min.js"></script>
<script>
    // ... (kode Firebase config dan variabel lainnya)

    // Perhatikan bahwa allBirthdayPages sudah di-load di loadAllData()
    // sehingga kita bisa langsung menggunakannya di renderUsers()

    function renderUsers(adminsObject) {
        userList.innerHTML = '';
        const adminIds = Object.keys(adminsObject);
        
        if (adminIds.length === 0) {
            noDataMessage.classList.remove('hidden');
            return;
        }
        
        noDataMessage.classList.add('hidden');
        
        adminIds.forEach(id => {
            const admin = adminsObject[id];
            const birthdayPageData = allBirthdayPages[id] || {};

            const date = admin.createdAt ? new Date(admin.createdAt) : new Date();
            const formattedDate = date.toLocaleDateString('id-ID', { day: '2-digit', month: 'long', year: 'numeric' });
            const firstLetter = admin.username ? admin.username.charAt(0).toUpperCase() : '?';

            // Dapatkan username dan password tamu
            const guestUser = birthdayPageData.guestUser || '';
            const guestPass = birthdayPageData.guestPass || '';

            // Encode kredensial tamu untuk URL
            // Kita akan menggunakan btoa untuk encoding Base64 sederhana
            const encodedGuestCredentials = btoa(JSON.stringify({ user: guestUser, pass: guestPass }));

            // Construct the shareable link for the birthday page with encoded credentials
            // Tambahkan parameter 'auth' ke URL
            const shareableLink = `${window.location.origin}/index.html?id=${id}&auth=${encodedGuestCredentials}`;
            const adminPanelLink = `${window.location.origin}/admin.html?id=${id}`;

            const card = document.createElement('div');
            card.className = 'user-card neumorphic-panel';
            card.dataset.adminId = id;
            card.innerHTML = `
                <div class="user-card-header">
                    <div class="user-avatar neumorphic-inset">${firstLetter}</div>
                    <div class="user-info">
                        <h3>${admin.username || 'N/A'}</h3>
                        <p>ID: ${id}</p>
                    </div>
                </div>
                <div class="user-card-body">
                    <div>
                        <span class="label">Password Admin:</span>
                        <span class="value password-value">${admin.password || 'N/A'}</span>
                    </div>
                    <div>
                        <span class="label">Nama Target:</span>
                        <span class="value">${birthdayPageData.birthdayName || 'N/A'}</span>
                    </div>
                    <div>
                        <span class="label">Tgl Lahir Target:</span>
                        <span class="value">${birthdayPageData.birthDate || 'N/A'}</span>
                    </div>
                    <div>
                        <span class="label">Username Tamu:</span>
                        <span class="value">${birthdayPageData.guestUser || 'N/A'}</span>
                    </div>
                    <div>
                        <span class="label">Pass Tamu:</span>
                        <span class="value">${birthdayPageData.guestPass || 'N/A'}</span>
                    </div>
                    <div>
                        <span class="label">WA Target:</span>
                        <span class="value">${birthdayPageData.targetWhatsappNumber || 'N/A'}</span>
                    </div>
                    <div>
                        <span class="label">Link Halaman:</span>
                        <span class="value">
                            <a href="${shareableLink}" target="_blank" style="color: var(--primary); text-decoration: none;">
                                Lihat Halaman (Auto Login) <i class="fas fa-external-link-alt"></i>
                            </a>
                        </span>
                    </div>
                    <div>
                        <span class="label">Dibuat:</span>
                        <span class="value">${formattedDate}</span>
                    </div>
                </div>
                <div class="user-card-actions">
                    <button class="btn btn-primary btn-access" onclick="accessAdminPanel('${id}')"><i class="fas fa-user-cog"></i> Akses Panel</button>
                    <button class="btn btn-edit" onclick="openEditModal('${id}')"><i class="fas fa-edit"></i> Edit Admin</button>
                    <button class="btn btn-danger" onclick="deleteUser('${id}', '${admin.username}')"><i class="fas fa-trash"></i> Hapus</button>
                </div>
            `;
            userList.appendChild(card);
        });
    }

    // ... (rest of data_management.html script)
</script>
